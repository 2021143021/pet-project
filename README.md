# 🐾 애완동물(개·고양이) 품종 분류 AI 시스템  
## 인공지능 개발 프로젝트 최종보고서

**프로젝트명:** AI Pet Breed Classifier (37종)  
**과목명:** 인공지능개발프로젝트  
**학번 / 이름:** 20XXXXXX ○○○  
**제출일:** 2025년 12월  

---

## 1. 프로젝트 개요

### 1.1 프로젝트명

**AI Pet Breed Classifier (37종)**  
Oxford-IIIT Pet Dataset 기반 개·고양이 품종 분류 시스템

### 1.2 프로젝트 목표

이미지 한 장만으로 **개·고양이 37종의 품종을 자동으로 분류**하고,  
웹 화면에서 품종 이름·예측 확률·상위 3개 후보를 직관적으로 보여주는 AI 시스템을 구축하는 것이 목표이다.

구체적으로는 다음을 달성하고자 한다.

- 개·고양이 품종 37종에 대한 이미지 분류 모델 구축
- 희귀하거나 생소한 품종도 사람보다 빠르게 인식하는 보조 도구 역할 수행
- 딥러닝 모델을 **Streamlit 웹 애플리케이션**과 연결하여  
  사용자가 코드 지식 없이도 브라우저에서 바로 테스트할 수 있는 형태로 제공

### 1.3 개발 동기 및 필요성

반려동물 문화가 확산되면서, SNS나 입양 공고 등에서 다양한 품종의 개와 고양이를 접하게 된다.  
하지만 **일반 사용자가 사진만 보고 정확한 품종을 구분하기는 쉽지 않다.**

특히 다음과 같은 상황에서 품종 인식 보조 도구가 유용할 수 있다.

- 보호소/입양 공고에서 잘 알려지지 않은 품종의 특징을 알고 싶을 때  
- 반려동물을 처음 보는 사람에게 “어떤 품종인지”를 설명해주고 싶을 때  
- 비슷하게 생긴 견종(예: pit bull 계열)이나 고양이 단모종을 구분하고 싶을 때  

이에 따라, **사진 한 장만으로 품종 후보를 빠르게 제안해주는 AI 서비스**를 만들고,  
그 과정에서 딥러닝 모델 학습부터 웹 서비스 배포 직전 단계까지의 개발 과정을 모두 경험하고자 했다.

---

## 2. 개발 환경 및 도구

| 항목 | 내용 |
| --- | --- |
| **언어** | Python 3.10 |
| **딥러닝 프레임워크** | TensorFlow 2.x / Keras |
| **모델 백본** | MobileNetV2 (ImageNet 사전 학습) |
| **웹 프레임워크(UI)** | Streamlit |
| **데이터셋** | Oxford-IIIT Pet Dataset (개·고양이 37종) |
| **이미지 처리** | Pillow(PIL), NumPy |
| **개발 환경** | Google Colab(모델 학습), VSCode + Windows(로컬 실행) |
| **버전 관리** | Git / GitHub (보고서 및 코드 관리) |

---

## 3. 시스템 구조

### 3.1 전체 시스템 구성

본 프로젝트는 크게 **모델 학습 파트**와 **웹 서비스 파트**로 나눌 수 있다.

1. **모델 학습 파이프라인 (Colab)**  
   - Oxford-IIIT Pet Dataset 로드  
   - 이미지 전처리 (리사이즈, 정규화, 라벨 인코딩)  
   - MobileNetV2를 활용한 Transfer Learning  
   - 학습된 모델을 `.h5` 포맷으로 저장  

2. **웹 애플리케이션 파이프라인 (Streamlit)**  
   - 사용자가 웹에서 이미지를 업로드  
   - 업로드된 이미지를 224×224로 전처리 후 정규화  
   - 로컬에 저장된 `pet_breed_classifier_finetuned.h5` 로 예측 수행  
   - 예측 결과(품종 이름, 확률, Top-3 후보)를 시각적으로 출력  

### 3.2 흐름도

```text
사용자 이미지 업로드
      ↓
이미지 전처리 (224×224, 정규화)
      ↓
Fine-Tuned MobileNetV2 분류 모델
      ↓
품종별 확률 벡터 (37차원 Softmax 출력)
      ↓
가장 높은 확률의 품종 + 상위 3개 품종 선택
      ↓
Streamlit UI에 결과 시각화 (메시지 + Top-3 리스트)

## 4. 모델 학습 및 성능

### 4.1 모델 구조

| 항목 | 내용 |
|:---:|:---|
| **Base Model** | MobileNetV2 (ImageNet 사전 학습, `include_top=False`) |
| **추가 레이어** | Global Average Pooling → Dense(ReLU) → Dropout → Dense(37, Softmax) |
| **입력 크기** | 224 × 224 × 3 (RGB 이미지) |
| **출력 클래스** | 개·고양이 37개 품종 |
| **손실 함수** | Categorical CrossEntropy |
| **옵티마이저** | Adam (학습률은 코드에서 조정) |

### 4.2 학습 전략

* **데이터 분할**
  * 학습용 / 검증용 데이터로 분리하여 과적합 여부를 확인하였다.
* **전처리**
  * 모든 이미지를 `224×224` 크기로 리사이즈
  * 픽셀 값 / `255.0` 으로 정규화하여 0~1 범위로 맞춤
* **Fine-Tuning**
  * MobileNetV2의 상단 일부 레이어는 고정하거나, 후반부 레이어부터 점진적으로 학습을 허용하여 성능과 속도의 균형을 맞추었다.
* **모델 저장**
  * 학습이 끝난 모델을 `.h5` 형식으로 저장(`pet_breed_classifier_finetuned.h5`), 로컬에서 Streamlit 앱이 직접 불러 사용할 수 있도록 구성하였다.

### 4.3 성능 요약

별도의 정량적인 테스트 셋(정답 라벨 포함)을 따로 구축하지는 못했지만, 여러 품종(37종)에 대해 직접 이미지를 넣어본 결과 다음과 같은 특징을 확인했다.

* **Basset Hound, Samoyed, Yorkshire Terrier, Scottish Terrier** 등 외형이 뚜렷한 견종은 **95~99%** 수준의 높은 확률로 일관되게 예측되었다.
* **Egyptian Mau, Russian Blue** 등 희귀 고양이 품종에서도 높은 확률(**90% 이상**) 을 보여주었다.
* 유사한 외형을 가진 종들(예: **Staffordshire Bull Terrier vs American Pit Bull Terrier**)은 1, 2위 확률이 서로 비슷하게 나와 모델도 애매해하는 모습을 보였다.
* 평균 추론 시간은 로컬 CPU 환경 기준으로 약 **1~2초** 수준으로, Streamlit 웹 앱에서 실시간으로 사용하기에 충분한 속도이다.
